<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.Group?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Pane?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.Arc?>
<?import javafx.scene.shape.Line?>
<?import javafx.scene.shape.Polyline?>

<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.chart.AreaChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<BorderPane fx:id="root" styleClass="manager-dashboard" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="view.manager.ManagerDashboardView">

    <top>
        <HBox alignment="CENTER_LEFT" spacing="20.0" styleClass="dashboard-topbar">
            <BorderPane.margin>
                <Insets bottom="0.0" left="32.0" right="32.0" top="20.0" />
            </BorderPane.margin>

            <HBox alignment="CENTER_LEFT" spacing="10.0">
                <Label styleClass="brand-icon" text="+" />
                <Label styleClass="brand-text" text="Spitalul Central" />
            </HBox>

            <Region HBox.hgrow="ALWAYS" />

            <HBox alignment="CENTER_RIGHT" spacing="10.0">
                <StackPane styleClass="profile-avatar">
                    <Label fx:id="managerInitialsLabel" styleClass="profile-initials" text="MG" />
                </StackPane>
                <Label fx:id="managerNameLabel" styleClass="profile-name" text="Manager" />
                <Button onAction="#onLogoutClick" styleClass="ghost-button" text="Logout" />
            </HBox>
        </HBox>
    </top>

    <center>
        <VBox styleClass="main">
            <ScrollPane fitToWidth="true" hbarPolicy="NEVER" styleClass="main-scroll" vbarPolicy="AS_NEEDED">
                <VBox styleClass="content-root" spacing="20">

                    <HBox alignment="CENTER_LEFT" spacing="10.0" styleClass="page-header">
                        <VBox spacing="4.0" HBox.hgrow="ALWAYS">
                            <Label fx:id="welcomeLabel" styleClass="page-title" text="Panou de Control Manager" />
                            <Label styleClass="page-subtitle" text="Administrare programări și flux pacienți" />
                        </VBox>
                    </HBox>

                    <HBox spacing="12.0" styleClass="stats-row">
                        <VBox spacing="8.0" styleClass="stat-card" HBox.hgrow="ALWAYS">
                            <HBox alignment="CENTER_LEFT" spacing="8.0">
                                <StackPane styleClass="stat-icon stat-blue"><Label styleClass="stat-icon-text" text="PT" /></StackPane>
                                <Label text="+12%" styleClass="stat-tag stat-tag-up" />
                            </HBox>
                            <Label styleClass="stat-title" text="Total Pacienti Astazi" />
                            <Label fx:id="patientsTodayLabel" text="-" styleClass="stat-value" />
                        </VBox>

                        <VBox spacing="8.0" styleClass="stat-card" HBox.hgrow="ALWAYS">
                            <HBox alignment="CENTER_LEFT" spacing="8.0">
                                <StackPane styleClass="stat-icon stat-purple"><Label styleClass="stat-icon-text" text="CA" /></StackPane>
                                <Label text="+5%" styleClass="stat-tag stat-tag-up" />
                            </HBox>
                            <Label styleClass="stat-title" text="Consultatii Active" />
                            <Label fx:id="activeConsultationsLabel" text="-" styleClass="stat-value" />
                        </VBox>

                        <VBox spacing="8.0" styleClass="stat-card" HBox.hgrow="ALWAYS">
                            <HBox alignment="CENTER_LEFT" spacing="8.0">
                                <StackPane styleClass="stat-icon stat-orange"><Label styleClass="stat-icon-text" text="GM" /></StackPane>
                                <Label text="-2%" styleClass="stat-tag stat-tag-down" />
                            </HBox>
                            <Label styleClass="stat-title" text="Grad Ocupare Medici" />
                            <Label fx:id="doctorOccupancyLabel" text="-" styleClass="stat-value" />
                        </VBox>
                    </HBox>

                    <HBox spacing="15.0" styleClass="charts-row" prefHeight="300">

                        <VBox spacing="10.0" styleClass="chart-card" HBox.hgrow="ALWAYS">
                            <Label styleClass="card-title" text="Flux Pacienți (Ultimele 7 zile)" />

                            <AreaChart fx:id="flowChart" legendVisible="false" createSymbols="true" style="-fx-background-color: transparent;">
                                <xAxis>
                                    <CategoryAxis label="Zile" />
                                </xAxis>
                                <yAxis>
                                    <NumberAxis label="Nr. Pacienți" />
                                </yAxis>
                            </AreaChart>
                        </VBox>

                        <VBox prefWidth="380.0" spacing="10.0" styleClass="chart-card">
                            <Label styleClass="card-title" text="Distribuție pe Secții" />

                            <PieChart fx:id="specializationPieChart" labelsVisible="false" legendVisible="true" legendSide="BOTTOM" />
                        </VBox>

                    </HBox>

                    <VBox styleClass="table-card" VBox.vgrow="ALWAYS" spacing="15">

                        <HBox alignment="CENTER_LEFT" spacing="15.0" styleClass="filter-row">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <VBox spacing="2.0">
                                    <Label styleClass="filter-label" text="Data" />
                                    <DatePicker fx:id="datePicker" styleClass="modern-input" prefWidth="140"/>
                                </VBox>

                                <VBox spacing="2.0">
                                    <Label styleClass="filter-label" text="Serviciu" />
                                    <ComboBox fx:id="serviceFilterCombo" styleClass="modern-input" prefWidth="180" promptText="Toate"/>
                                </VBox>
                            </HBox>

                            <Region HBox.hgrow="ALWAYS" />

                            <HBox spacing="10" alignment="CENTER_RIGHT">
                                <Button text="Vezi Istoric" onAction="#onViewHistoryClick"
                                        styleClass="action-button, btn-info" textFill="WHITE">
                                </Button>

                                <Button text="Editează" onAction="#onEditUserClick"
                                        styleClass="action-button, btn-warning" textFill="WHITE"/>

                                <Button text="Schimbă Status" onAction="#onChangeStatusClick"
                                        styleClass="action-button, btn-primary" textFill="WHITE"/>
                            </HBox>
                        </HBox>

                        <TableView fx:id="appointmentsTable" prefHeight="500.0" styleClass="modern-table">
                            <columns>
                                <TableColumn fx:id="patientCol" text="PACIENT" prefWidth="200" />
                                <TableColumn fx:id="doctorCol" text="MEDIC" prefWidth="200" />
                                <TableColumn fx:id="serviceCol" text="SERVICIU" prefWidth="180" />
                                <TableColumn fx:id="timeCol" text="ORA" prefWidth="100" style="-fx-alignment: CENTER;" />
                                <TableColumn fx:id="statusCol" text="STATUS" prefWidth="120" style="-fx-alignment: CENTER;" />
                            </columns>
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                            </columnResizePolicy>
                            <placeholder>
                                <Label text="Nu există programări pentru criteriile selectate." style="-fx-text-fill: #999; -fx-font-size: 14px;"/>
                            </placeholder>
                        </TableView>

                    </VBox>

                    <Label fx:id="statusLabel" styleClass="status-message" text="" />
                </VBox>
            </ScrollPane>
        </VBox>
    </center>
</BorderPane>